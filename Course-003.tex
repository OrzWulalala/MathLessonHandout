\documentclass[UTF8]{article}

\usepackage{CTEX}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{graphicx}

\begin{document} 

\lstset{
	language=C++,
    numberstyle= \tiny\monaco, 
    keywordstyle= \color{ blue!70},
    commentstyle= \color{red!50!green!50!blue!50}, 
    frame=shadowbox, % 阴影效果
    rulesepcolor= \color{ red!20!green!20!blue!20} ,
    escapeinside=``, % 英文分号中可写入中文
    breaklines=true,
    tabsize = 4,
    xleftmargin=2em, aboveskip=1em,
    framexleftmargin=2em
}

\section{线性空间与基向量:}
\subsection{线性空间:}

设有空间$V$，如果在$V$中的向量$\vec{x}, \vec{y}$，有$\forall \vec{x}, \vec{y} \in V,$且满足:
$$\forall k \in R, k\cdot \vec{x} \in V$$
$$\forall \alpha,\beta \in R, \alpha\cdot \vec{x} + \beta\cdot\vec{y} \in V$$
我们称空间$V$是线性空间。常见的$R, R^2, R^3$都是线性空间。

下面我们以二维平面$R^2$为例讨论有关线性空间的内容。

\subsection{线性空间的基} 
在二维平面$R^2$中，建立平面直角坐标系$XOY$,在这个坐标系中，有两条向量是非常特殊的，记为$\vec{e}_i = 
\left(
\begin{array}{l}
1 \\ 
0
\end{array}
\right),
\vec{e}_j = 
\left(
\begin{array}{l}
0 \\ 
1
\end{array}
\right)$,通常称这两条向量称为二维平面空间中的一对基向量;
$XOY$坐标系中任意一条向量$\vec{u} = 
\left(
\begin{array}{l}
x \\ 
y
\end{array}
\right)
$都可以看作$\vec{e}_i, \vec{e}_j$的线性组合:
$$
\left(
\begin{array}{l}
x \\ 
y
\end{array}
\right) = x\cdot
\left(
\begin{array}{l}
1 \\ 
0
\end{array}
\right) + y\cdot
\left(
\begin{array}{l}
0 \\ 
1
\end{array}
\right)
$$
相对应的，我们称平面$XOY$是由向量$\vec{e}_i, \vec{e}_j$张成的空间，记$
\left(
\begin{array}{l}
x \\ 
y
\end{array}
\right)
$为向量$\vec{u}$在这对基向量张成空间下的坐标。

默认状态下，我们认为一个向量的坐标即为它在$XOY$坐标系中的坐标。

\subsubsection{线性相关与线性无关:}
对于一组向量(多于一个)$\vec{a}_1, \vec{a}_2, ..., \vec{a}_n$，如果存在不全为$0$的系数$k_1, k_2, ..., k_n$,使得$\sum_{i = 1}^{k}{k_i\cdot \vec{a}_i} = 0$,则称$\vec{a}_1, \vec{a}_2, ..., \vec{a}_n$是一组线性相关的向量;

反之，若当且仅当$k_1 = k_2 = ... = k_n = 0$时，才能使$\sum_{i = 1}^{k}{k_i\cdot \vec{a}_i} = 0$成立，则称$\vec{a}_1, \vec{a}_2, ..., \vec{a}_n$是一组线性无关的向量。

\begin{itemize}
	\item 在$XOY$平面内，两个向量线性相关意味着两个向量是共线的。
	\item 在$XOY$平面内,超过三个向量一定线性相关。
\end{itemize}

我们说任意一组线性无关的向量可以张成一个线性空间，向量组中向量的个数称为该线性空间的秩。

\subsubsection{线性空间的基与向量坐标的计算:}

\begin{itemize}
	\item 设$XOY$中有向量$\vec{u} = 
\left(
\begin{array}{l}
5 \\ 
7
\end{array}
\right)
$,显然在以$\vec{e}_i = 
\left(
\begin{array}{l}
1 \\ 
0
\end{array}
\right), \vec{e}_j = 
\left(
\begin{array}{l}
0 \\ 
1
\end{array}
\right)$的原坐标系中坐标为$
\left(
\begin{array}{l}
5 \\ 
7
\end{array}
\right)$.

我们现在以另一组向量$\vec{e}_p = 
\left(
\begin{array}{l}
1 \\ 
1
\end{array}
\right), \vec{e}_q = 
\left(
\begin{array}{l}
-1 \\ 
1
\end{array}
\right)$为基张成另一个线性空间$V_1$,在这个新的线性空间中，向量$\vec{u}$的坐标就换成了另一对$
\left(
\begin{array}{l}
u_x \\ 
u_y
\end{array}
\right)
$,且满足$u_x\cdot \vec{e}_0 + u_y\cdot \vec{e}_1 = \vec{u}
$,即$$
u_x\cdot \left(
\begin{array}{l}
1 \\ 
1
\end{array}
\right) + u_y\cdot \left(
\begin{array}{l}
-1 \\ 
1
\end{array}
\right) = \left(
\begin{array}{l}
5 \\ 
7
\end{array}
\right)
$$

联立得到方程$$
\left\{
\begin{array}{l}
u_x - u_y = 5 \\ 
u_x + u_y = 7
\end{array}
\right.
$$

解方程得$$
\left\{
\begin{array}{l}
u_x = 6 \\
u_y = 1
\end{array}
\right.
$$

于是得到向量$\vec{u}$在线性空间$V_1$中的坐标为$
\left(
\begin{array}{l}
6 \\
1
\end{array}
\right)
$

	\item 
类似的，对于在空间$V_1$中的向量$\vec{u} = 
\left(
\begin{array}{l}
u_x \\ 
u_y
\end{array}
\right)
$,可以计算该向量在$XOY$平面中的坐标:
$$ \vec{e}_0 = 
\left(
\begin{array}{l}
1 \\ 
1
\end{array}
\right),
\vec{e}_1 = 
\left(
\begin{array}{l}
-1 \\ 
1
\end{array}
\right)$$

于是可以计算得出在原坐标系中:
$$\vec{u} = u_x\cdot \vec{e}_0 + u_y\cdot\vec{e}_1$$

即$$\vec{u} = u_x\cdot \left(
\begin{array}{l}
1 \\ 
1
\end{array}
\right) + u_y\cdot \left(
\begin{array}{l}
-1 \\ 
1
\end{array}
\right) = 
\left(
\begin{array}{l}
u_x - u_y \\ 
u_x + u_y
\end{array}
\right)$$
即为在$XOY$平面中的坐标

\end{itemize}

\section{线性变换:}

我们考虑二维向量空间$V$中的映射:$f:\vec{u}\rightarrow \vec{v}, \vec{u},\vec{v} \in V$:
例如变换:
$$\vec{u} = \left(
\begin{array}{l}
u_x \\ 
u_y
\end{array}
\right), \vec{v} = f(\vec{u}) = \left(
\begin{array}{l}
2\cdot u_x - u_y \\ 
-3\cdot u_x + 2\cdot u_y
\end{array}
\right)$$

会将向量$\vec{u}_1 = \left(
\begin{array}{l}
2 \\ 
5
\end{array}
\right)$变换为向量$\vec{v}_1 = \left(
\begin{array}{l}
-1 \\ 
4
\end{array}
\right)$,

将向量$\vec{u}_2 = \left(
\begin{array}{l}
3 \\ 
1
\end{array}
\right)$变换为向量$\vec{v}_2 = \left(
\begin{array}{l}
5 \\ 
-7
\end{array}
\right)$

事实上,我们发现上述的线性变换的结果其实就是以$$\vec{e}_0 = \left(
\begin{array}{l}
2 \\ 
-3
\end{array}
\right), \vec{e}_1 = \left(
\begin{array}{l}
-1 \\ 
2
\end{array}
\right)$$为基底的线性空间中的向量$$\vec{u} = \left(
\begin{array}{l}
u_x \\ 
u_y
\end{array}
\right)$$在以$$\vec{e}_i = \left(
\begin{array}{l}
1 \\ 
0
\end{array}
\right), \vec{e}_j = \left(
\begin{array}{l}
0 \\ 
1
\end{array}
\right)$$为基的$XOY$平面中的坐标;

向量$\vec{u}$在$XOY$平面中的坐标为
$$u_x\cdot \vec{e}_0 + u_y\cdot \vec{e}_1$$
$$= u_x\cdot \left(
\begin{array}{l}
2 \\ 
-3
\end{array}
\right) + u_y\cdot \left(
\begin{array}{l}
-1 \\ 
2
\end{array}
\right) = \left(
\begin{array}{l}
2\cdot u_x - u_y \\ 
-3\cdot u_x + 2\cdot u_y
\end{array}
\right)$$

我们也可以认为上述过程是将$XOY$平面(以$\vec{e}_i, \vec{e}_j$为基)内的一个向量$\vec{u}$,保持其坐标不变，将$XOY$平面变换到以$\vec{e}_0, \vec{e}_1$为基的平面后，随之变换得到的向量$\vec{u}^{'}$在原来的$XOY$平面中的坐标;这样的变换是一种线性变换。

在线性变换中，我们可以视为将线性空间$V$中的向量$\vec{u}$变换为另一个线性空间$V^1$中的向量$\vec{u}^{'}$,其本质是空间本身的变化，而向量$\vec{u}$在两个空间中的坐标是不变的。

\section{矩阵与矩阵乘法:}

\subsection{矩阵的定义:}
定义：由$m \times n$个数字$a_{ij}$构成的$m$行$n$列的表称为一个$m$行$n$列的矩阵，一个$2\times 2$的矩阵可以表示为：
$$\left(
\begin{array}{l}
a_{11}\quad a_{12} \\ 
a_{21}\quad a_{22}
\end{array}
\right)$$

我们常用大写字母$A_{m\times n}, B_{m\times n}, ...$表示一个$m$行$n$列的矩阵，其对应的小写字母加角标的方式表示矩阵中的元素。例如上述的矩阵就可以记作$A_{2\times 2} = \left(
\begin{array}{l}
a_{11}\quad a_{12} \\ 
a_{21}\quad a_{22}
\end{array}
\right)$,其中的$a_{ij}$表示在第$i$行第$j$列的元素。


\subsection{矩阵与线性变换:}
对于$XOY$平面中的向量$\vec{u} = \left(
\begin{array}{l}
u_x \\ 
u_y
\end{array}
\right)$,其坐标为$(u_x, u_y)$,关于平面中的基向量$\vec{e}_i, \vec{e}_j$的表示为$\vec{u} = u_x\cdot \vec{e}_i + u_y\cdot \vec{e}_j$,这类似于向量点积$(\vec{e}_i, \vec{e}_j)\cdot(u_x, u_y) = u_x\cdot \vec{e}_i + u_y\cdot \vec{e}_j$,这里我们只需将$\vec{e}_i, \vec{e}_j$视作列向量即可。

我们将上述的$(\vec{e}_i, \vec{e}_j)$分别写成列向量的形式，即为$\left(
\begin{array}{l}
1\quad 0 \\ 
0\quad 1
\end{array}
\right)$，那么我们有:$$(\vec{e}_i, \vec{e}_j)\cdot(u_x, u_y) = \left(
\begin{array}{l}
1\quad 0 \\ 
0\quad 1
\end{array}
\right) \cdot \left(
\begin{array}{l}
u_x \\ 
u_y
\end{array}
\right) = u_x\cdot \left(
\begin{array}{l}
1 \\ 
0
\end{array}
\right) + u_y\cdot \left(
\begin{array}{l}
0 \\ 
1
\end{array}
\right) = \left(
\begin{array}{l}
u_x \\ 
u_y
\end{array}
\right)$$.

如果我们换一组线性空间的基向量$\vec{e}_0 = \left(
\begin{array}{l}
1 \\ 
2
\end{array}
\right), \vec{e}_1 = \left(
\begin{array}{l}
3 \\ 
1
\end{array}
\right)$,那么在这组基向量张成的二维平面中，坐标为$(-1, 2)$的向量实际的坐标为:$$\left(
\begin{array}{l}
1\quad 3 \\ 
2\quad 1
\end{array}
\right) \cdot \left(
\begin{array}{l}
-1 \\ 
2
\end{array}
\right) = -1\cdot \left(
\begin{array}{l}
1 \\ 
2
\end{array}
\right) + 2\cdot \left(
\begin{array}{l}
3 \\ 
1
\end{array}
\right) = \left(
\begin{array}{l}
5 \\ 
0
\end{array}
\right)$$
不难发现，该变换将向量$\left(
\begin{array}{l}
1 \\ 
2
\end{array}
\right)$变换为了另一个向量$\left(
\begin{array}{l}
5 \\ 
0
\end{array}
\right)$,这里的$\left(
\begin{array}{l}
1\quad 3 \\ 
2\quad 1
\end{array}
\right)$称为变换矩阵。

\subsection{矩阵的基本运算与性质:}

数乘:对于矩阵$A_{m\times n}$,有
$$k\cdot A = 
\left(
\begin{array}{l}
k\cdot a_{11} \quad k\cdot a_{12} \quad ... \quad k\cdot a_{1n} \\ 
k\cdot a_{21} \quad k\cdot a_{22} \quad ... \quad k\cdot a_{2n} \\
... \\
k\cdot a_{m1} \quad k\cdot a_{m2} \quad ... \quad k\cdot a_{mn}
\end{array}
\right)$$

矩阵加法:对于矩阵$A_{m\times n}, B_{m\times n}$,有
$$C_{m\times n} = A_{m\times n} + B_{m\times n} = 
\left(
\begin{array}{l}
a_{11} + b_{11} \quad a_{12} + b_{12} \quad ... \quad a_{1n} + b_{1n} \\ 
a_{21} + b_{21} \quad a_{22} + b_{22} \quad ... \quad a_{2n} + b_{2n} \\
... \\
a_{m1} + b_{m1} \quad a_{m2} + b_{m2} \quad ... \quad a_{mn} + b_{mn}
\end{array}
\right)$$

矩阵乘法:对于矩阵$A_{m\times n}, B_{n\times k}$,有
$$C_{m\times k} = A_{m\times n} \times B_{n\times k},C_{ij} = \sum_{k = 1}^{n}{A_{ik}\cdot B_{kj}}$$

\begin{itemize}
	\item $C_{ij}$的值实际上是矩阵$A$的第i行的行向量$(A_{i1}, A_{i2}, ..., A{in})$，与矩阵$B$的第j列的列向量$\left(
\begin{array}{l}
B_{1j} \\ 
B_{2j} \\
... \\
B_{nj}
\end{array}
\right)$，两者的点积
	\item Tips:矩阵乘法满足结合律与结合律，但不一定满足交换律。
\end{itemize}

特别的，在线性变换中，我们可以将列向量$\vec{u}$视作一个2行1列的矩阵，也满足矩阵乘法的定义。

\subsection{思考题:}

\begin{itemize}
	\item 现有n阶方阵$A_{n\times n}, B_{n\times n}$.试验证$A\cdot B \neq B\cdot A$

\end{itemize}


\section{矩阵乘法与快速幂:}


现在考虑一个经典的$fibonacci$数列问题:$f_1 = f_2 = 1, f_n = f_{n-1} + f_{n-1}$.求$f_n$?

按照正常的思路考虑，我们可以写一个循环直接求出$f_n$的值,但是如果n的值非常大，循环会超时该怎么办呢?

回到之前提到的线性变换:$f:\vec{x}\rightarrow \vec{b}, \vec{x}, \vec{b}\in R^2$,我们发现在二维平面中的线性变换相当于给向量$\vec{x}$左乘一个变换矩阵$A$,即$f:\vec{x} \rightarrow A \vec{x} = \vec{b}$。

我们现在考虑向量$\vec{x} = \left(
\begin{array}{l}
f_n \\ 
f_{n-1}
\end{array}
\right)$,如果存在变换矩阵$A$可以使得$A\vec{x} = \left(
\begin{array}{l}
f_{n+1} \\ 
\ f_{n}
\end{array}
\right)$，由于我们已经知道$\vec{x}_0 = \left(
\begin{array}{l}
f_2 \\ 
f_1
\end{array}
\right) = \left(
\begin{array}{l}
1 \\ 
1
\end{array}
\right)$,那么就容易有
$$A\cdot\vec{x}_0 = \left(
\begin{array}{l}
f_3 \\ 
f_2
\end{array}
\right)
$$
$$A\cdot A\cdot \vec{x}_0 = \left(
\begin{array}{l}
f_4 \\ 
f_3
\end{array}
\right)
$$


依次类推，我们有$$A^{n-2} \cdot \vec{x}_0 = \left(
\begin{array}{l}
f_n \\ 
f_{n-1}
\end{array}
\right)$$

我们只需要使用快速幂直接计算出$A^{n-2}$，再左乘到向量$\left(
\begin{array}{l}
f_2 \\ 
f_1
\end{array}
\right)$上就能直接得到$\left(
\begin{array}{l}
\ f_n \\ 
f_{n-1}
\end{array}
\right)$

那么变换矩阵$A$该如何求呢？设矩阵$A = \left(
\begin{array}{l}
a_{11} \quad a_{12}\\ 
a_{21} \quad a_{21}
\end{array}
\right),$我们容易列出等式
$$\left(
\begin{array}{l}
a_{11} \quad a_{12}\\ 
a_{21} \quad a_{21}
\end{array}
\right) \cdot \left(
\begin{array}{l}
\ f_i\\ 
f_{i-1}
\end{array}
\right) = \left(
\begin{array}{l}
a_{11}\cdot f_i + a_{12} \cdot f_{i-1}\\ 
a_{21}\cdot f_i + a_{22} \cdot f_{i-1}
\end{array}
\right) = \left(
\begin{array}{l}
f_{i+1}\\ 
\ f_i
\end{array}
\right) = \left(
\begin{array}{l}
f_i+ f_{i-1}\\ 
\quad f_i
\end{array}
\right)$$.

直接使用待定系数法即可求出$A = \left(
\begin{array}{l}
1 \quad 1\\ 
1 \quad 0
\end{array}
\right)$

结构体定义:

\begin{lstlisting}
struct Matrix{
	int row, col, data[110][110];
	Matrix(){
		row = col = 0;
		memset(data, 0, sizeof(data));
	}
	friend Matrix operator* (const Matrix &A, const Matrix &B){
		Matrix ans;
		ans.row = A.row, ans.col = B.col;
		for (int i = 1; i <= ans.row; i ++)
			for (int j = 1; j <= ans.col; j ++)
				for (int k = 1; k <= A.col; k ++)
					ans.data[i][j] += A.data[i][k] * B.data[k][j];
		return ans;
	}
};
\end{lstlisting}

\newpage
使用快速幂计算矩阵$A^n$

\begin{lstlisting}
Matrix pow(Matrix A, int k){
	Matrix ans, base = A;
	ans.row = A.row, ans.col = A.col;
	for (int i = 1; i <= ans.row; i ++)
		ans.data[i][i] = 1;
	while (k){
		if (k & 1)
			ans = ans * base;
		k >>= 1;
		base = base * base;
	}
	return ans;
}
\end{lstlisting}

主程序调用:
\begin{lstlisting}
int main(){
	Matrix ans, A;
	ans.row = 2, ans.col = 1;
	ans.data[1][1] = ans.data[2][1] = 1;
	A.row = A.col = 2;
	A.data[1][1] = A.data[1][2] = A.data[2][1] = 1;
	int n;
	cin >> n;
	if (n <= 2)
		cout << 1;
	else {
		ans = pow(A, n-2) * ans;
		cout << ans.data[1][1];
	}
	return 0;
}	
\end{lstlisting}
\end{document} 